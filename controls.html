<!DOCTYPE html>
<html>
    <head>
      <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet">
        <style>
        body { 
            background: #000;
            margin: 0; 
           
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            font-family: 'Source Code Pro', monospace;
            color: #33ff33;
        } 
         
        .crt::before {
          content: " ";
          width: 100%;
          height: 100%;
          display: flex;
          position: absolute;
          top: 0;
          left: 0;
          bottom: 0;
          right: 0;
          background: 
              repeating-linear-gradient(90deg, 
                  black 0px, 
                  black 0.7px, 
                  transparent 0.5px, 
                  transparent 1px),
              linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
              linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
          z-index: 3;
          background-size: 1px 100%, 100% 0.5px, 1px 100%;
          pointer-events: none;
      }





         
        .crt::after { 
            content: " ";
        
            content: " ";
          width: 100%;
          height: 100%;
          display: flex;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background: rgba(18, 16, 16, 0.1);
  opacity: 0;
  z-index: 3;
  pointer-events: none;
        }
        
        .player { 
            border: 2px  #ffffff; 
            padding: 15px; 
            border-radius: 10px;
            position: relative;
            background-color: #000000;
            z-index:2;
        } 
        
        .line { 
            margin-left : 15px ; 
            margin-top : none;
            width: 360px;  
            border: 1px solid rgb(255, 255, 255); 
            position:relative;
            z-index:2;
            box-shadow: 0 0 5px #ffffff; 
        } 
        
        .line2 { 
            margin-top: 5px; 
            width: 360px; 
            height: px; 
            border-bottom: 2px solid white; 
            box-shadow: 0 0 5px #ffffff; 
        } 
        
        .transport-controls { 
            display: flex; 
            justify-content: center; 
            gap: 20px; 
            margin-bottom: 15px; 
            padding: 10px; 
            border-bottom: 1px solid #ffffff; 
        } 
        
        .btn { 
            background: #ffffff; 
            border: 2px solid #ffffff; 
            border-bottom: none;
            color: #000000; 
            padding: 8px 15px; 
            border-top-left-radius: 10px;
            border-top-right-radius: 10px; 
            cursor: pointer; 
            font-family: monospace; 
            text-transform: uppercase; 
            height : 35px;
            width : 50px;
            font-size: 15px; 
            transition: all .1s ease; 
            position : relative;
            overflow: hidden; 
            box-shadow: 0 0 5px #ffffff; 
     
        } 

        .btn2 { 
            margin-left:16px;
            background: #ffffff; 
            border: 2px solid #ffffff; 
            border-bottom: none;
            color: #000000; 
            padding: 8px 15px; 
            border-top-left-radius: 10px;
            border-top-right-radius: 10px; 
            cursor: pointer; 
            font-family: monospace; 
            text-transform: uppercase; 
            height : 35px;
            width : 50px;
            font-size: 15px; 
            transition: all 0.3s ease; 
            position : relative;
            overflow: hidden; 
            z-index: 1;
            box-shadow: 0 0 5px #ffffff; 
        } 
        
        .btn2.active {
          transform: translateY(15px);
          background-color: #33ff33;
          border : 2px solid #33ff33;
          box-shadow: 0 0 5px #33ff33; 
        }
        .btn:active {
          background-color: #33ff33;
          border : 2px solid #33ff33;
          transform: translateY(15px);
          box-shadow: 0 0 5px #33ff33; 
        }
        
        .progress-bar { 
            margin-top: 5px; 
            width: 99%; 
            height: 5px; 
            background: #111; 
            position: relative; 
            border: 1px solid #33ff33;
            border-top: dashed 2px #33ff33;
            border-bottom: dashed 2px #33ff33; 
            display:inline-block;
            box-shadow: 0 0 5px #33ff33; 
          
        } 
        
        .progress { 
            width: 30%; 
            height: 100%; 
            background: #33ff33; 
            position: relative; 
            animation: glitch 2s infinite;
            box-shadow: 0 0 5px #33ff33;  
        } 
        
        .cassette { 
            width: 150px; 
            height: 55px; 
            border: 2px solid #33ff33; 
            margin: 40px auto;
            border-radius: 50px; 
            position: relative; 
            display: flex; 
            justify-content: space-around; 
            align-items: center; 
            box-shadow: 0 0 5px #33ff33; 
        } 
        
        .reel { 
            width: 40px; 
            height: 40px;
            background-size: 40px;
            margin-left: 35px; 
            background-image: url('reel.png');
            background-repeat: no-repeat;
            background-position: center center;
            position: relative; 
       
           
        } 
        
        .breel { 
            width: 40px; 
            height: 40px;
            background-size: 40px;
            background-image: url('reel.png');
            background-repeat: no-repeat;
            background-position: center center;
            position: relative; 
            
          
        } 
        
        .song-name { 
            font-size: 15px; 
            color: #ffffff;
            text-shadow: 0 0 5px #ffffff; 
            animation: textGlitch 3s infinite; 
        } 
        
        .artist-name { 
            font-size: 10px; 
            color: #ffffff;
            text-shadow: 0 0 5px #ffffff; 
            animation: textGlitch 3s infinite; 
        } 
        
        .controls { 
            display: flex; 
            justify-content: space-between; 
        } 
        
        .time { 
            font-size: 12px; 
            color: #ffffff;
            text-shadow: 0 0 5px #ffffff; 
        }

        @keyframes flicker {
  0% {
    opacity: 0.27861;
  }
  5% {
    opacity: 0.34769;
  }
  10% {
    opacity: 0.23604;
  }
  15% {
    opacity: 0.90626;
  }
  20% {
    opacity: 0.18128;
  }
  25% {
    opacity: 0.83891;
  }
  30% {
    opacity: 0.65583;
  }
  35% {
    opacity: 0.67807;
  }
  40% {
    opacity: 0.26559;
  }
  45% {
    opacity: 0.84693;
  }
  50% {
    opacity: 0.96019;
  }
  55% {
    opacity: 0.08594;
  }
  60% {
    opacity: 0.20313;
  }
  65% {
    opacity: 0.71988;
  }
  70% {
    opacity: 0.53455;
  }
  75% {
    opacity: 0.37288;
  }
  80% {
    opacity: 0.71428;
  }
  85% {
    opacity: 0.70419;
  }
  90% {
    opacity: 0.7003;
  }
  95% {
    opacity: 0.36108;
  }
  100% {
    opacity: 0.24387;
  }
}

        
        @keyframes scanline { 0% {  transform: translateY(0); }  100% {  transform: translateY(100%); } } 
        @keyframes spin { from {  transform: rotate(0deg); }  to {  transform: rotate(360deg); } } 
        @keyframes glitch { 0%, 100% {  opacity: 1; }  50% {  opacity: 0.95; }  25%, 75% {  opacity: 0.9; } } 
        @keyframes buttonGlitch { 0%, 100% {  transform: translateX(0); }  25% {  transform: translateX(-1px); }  75% {  transform: translateX(1px); } } 
        @keyframes textGlitch { 0%, 100% {  opacity: 1;  transform: translateX(0); }  92% {  opacity: 0.9;  transform: translateX(1px); }  94% {  opacity: 0.85;  transform: translateX(-1px); }  96% {  opacity: 0.9;  transform: translateX(1px); } } 
    
        .reel.spin {
      animation: spin 2s linear infinite;
    }
    .breel.spin {
      animation: spin 2s linear infinite;
    }

        </style>
    </head>
    <body>
        <div class="crt">
            <button class="btn2" id="play-pause">►</button>
            <button class="btn" id="prev">◄◄</button>
            <button class="btn" id="next">►►</button>
            <div class="line"></div>
            <div class="player">
                <div class="cassette">
                    <div class="breel"></div>
                    <div class="reel"></div>
                </div>
                <div class="song-name" id="track-name">
                    Every Breath You Take
                </div>
                <div class="artist-name" id="track-artist">
                    The Police
                </div>
                <div class="progress-bar">
                  <div class="progress" id="progress"></div>
                </div>
                <div class="line2"></div>
                <div class="controls">
                    <span class="time" id="current-time">0:00</span>
                    <span class="time" id="total-duration">2:13</span>
                </div>
            </div>
        </div>

        <script>
            const playPauseButton = document.getElementById('play-pause');
            const nextButton = document.getElementById('next');
            const prevButton = document.getElementById('prev');
            const trackName = document.getElementById('track-name');
            const trackArtist = document.getElementById('track-artist');
            const progressBar = document.getElementById('progress');
            const currentTimeEl = document.getElementById('current-time');
            const totalDurationEl = document.getElementById('total-duration');
        
            let currentTrackDuration = 0;
            let currentTrackPosition = 0;
        
            function formatTime(ms) {
              const totalSeconds = Math.floor(ms / 1000);
              const minutes = Math.floor(totalSeconds / 60);
              const seconds = totalSeconds % 60;
              return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            }
        
            async function fetchPlayback() {
              try {
                const response = await fetch('http://localhost:8888/playback');
                const data = await response.json();
        
                if (data && data.item) {
                  trackName.textContent = data.item.name;
                  trackArtist.textContent = data.item.artists.map(artist => artist.name).join(', ');
                  currentTrackDuration = data.item.duration_ms;
                  currentTrackPosition = data.progress_ms;
        
                  totalDurationEl.textContent = formatTime(currentTrackDuration);
                  currentTimeEl.textContent = formatTime(currentTrackPosition);
        
                  const progressPercentage = (currentTrackPosition / currentTrackDuration) * 100;
                  progressBar.style.width = `${progressPercentage}%`;
        
                  const toggleButton = document.querySelector('.btn2');
                  if (data.is_playing) {
                     if (!toggleButton.classList.contains('active')) {
                         toggleButton.classList.add('active'); 
                      }
                 } else {
                    toggleButton.classList.remove('active');
                 }

                 const reel = document.querySelector('.reel');
                  if (data.is_playing) {
                      reel.classList.add('spin');
                  } else {
                      reel.classList.remove('spin'); 
                  }

                  const breel = document.querySelector('.breel');
                  if (data.is_playing) {
                      breel.classList.add('spin');
                  } else {
                      breel.classList.remove('spin'); 
                  }
                }


              } catch (error) {
                console.error('Error fetching playback info:', error);
              }
            }
        
            setInterval(() => {
              fetchPlayback();
            }, 500);
        
            playPauseButton.addEventListener('click', async () => {
              const action = 'playpause';
              try {
                await fetch(`http://localhost:8888/${action}`, { method: 'POST' });
                fetchPlayback();
              } catch (error) {
                console.error('Error controlling playback:', error);
              }
            });
        
            nextButton.addEventListener('click', async () => {
              try {
                await fetch('http://localhost:8888/next', { method: 'POST' });
                fetchPlayback();
              } catch (error) {
                console.error('Error controlling playback:', error);
              }
            });
        
            prevButton.addEventListener('click', async () => {
              try {
                await fetch('http://localhost:8888/previous', { method: 'POST' });
                fetchPlayback();
              } catch (error) {
                console.error('Error controlling playback:', error);
              }
            });
        
            fetchPlayback();

      </script>
    </body>
</html>